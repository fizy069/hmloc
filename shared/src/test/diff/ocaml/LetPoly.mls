let sqsum xs =
  let f a x = match x with | [] -> 0 | h::t -> 1 in
  let base = List.hd xs in List.fold_left f base xs;;
//│ [ERROR] Type `int` does not match `_ list`
//│ 
//│         (int) ---> (?a) ~~~~ (?b) <--- (?c) ~~~~ (?d) ~~~~ (?e) ---> (_ list)
//│ 
//│ ◉ (int) is here
//│ │  - l.2    let f a x = match x with | [] -> 0 | h::t -> 1 in
//│ │                                            ^
//│ ▼ 
//│ ◉ (?a) is assumed here
//│    - l.2    let f a x = match x with | [] -> 0 | h::t -> 1 in
//│                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│     ◉ (_ -> ?b -> ?a) is here
//│     │  - l.2    let f a x = match x with | [] -> 0 | h::t -> 1 in
//│     │                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│     │  - l.3    let base = List.hd xs in List.fold_left f base xs;;
//│     │                                                   ^
//│     ▼ 
//│     ◉ (?c -> ?d -> ?c) is here
//│        - lib. let List.fold_left : ('a -> 'b -> 'a) -> 'a -> 'b list -> 'a
//│                                     ^^^^^^^^^^^^^^
//│ ◉ (?c) is assumed here
//│ ▲  - l.3    let base = List.hd xs in List.fold_left f base xs;;
//│ │                                                     ^^^^
//│ │ 
//│ ◉ (?e) is assumed here
//│    - l.3    let base = List.hd xs in List.fold_left f base xs;;
//│                        ^^^^^^^^^^
//│   ◉ (?e list) is here
//│   ▲  - lib. let List.hd: 'a list -> 'a
//│   │                      ^^^^^^^
//│   │  - l.3    let base = List.hd xs in List.fold_left f base xs;;
//│   │                              ^^
//│   │  - l.1  let sqsum xs =
//│   │                   ^^
//│   │ 
//│   ◉ (?f) is assumed here
//│   │  - l.1  let sqsum xs =
//│   │                   ^^
//│   │  - l.3    let base = List.hd xs in List.fold_left f base xs;;
//│   │                                                          ^^
//│   ▼ 
//│   ◉ (?d list) is here
//│      - lib. let List.fold_left : ('a -> 'b -> 'a) -> 'a -> 'b list -> 'a
//│                                                            ^^^^^^^
//│     ◉ (?c -> ?d -> ?c) is here
//│     ▲  - lib. let List.fold_left : ('a -> 'b -> 'a) -> 'a -> 'b list -> 'a
//│     │                               ^^^^^^^^^^^^^^
//│     │  - l.3    let base = List.hd xs in List.fold_left f base xs;;
//│     │                                                   ^
//│     │ 
//│     ◉ (_ -> ?b -> ?a) is here
//│        - l.2    let f a x = match x with | [] -> 0 | h::t -> 1 in
//│                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ◉ (?b) is assumed here
//│ │  - l.2    let f a x = match x with | [] -> 0 | h::t -> 1 in
//│ │                   ^
//│ │  - l.2    let f a x = match x with | [] -> 0 | h::t -> 1 in
//│ │                             ^
//│ ▼ 
//│ ◉ (_ list) is here
//│    - l.2    let f a x = match x with | [] -> 0 | h::t -> 1 in
//│                                        ^^
//│ sqsum: (list[list[?]] & list['a]) -> (int | 'a)
//│ U max: 2, total: 17
//│ UERR 1 errors
//│ L: 2 [int ~ list['a79'], int <: α80', [α80' - (α78' -> α80') ~ (α76' -> α75') - α75', L: 1 [(α78' -> α80') ~ (α76' -> α75'), [(α78' -> α80') - (α77' -> (α78' -> α80')) ~ (α75' -> (α76' -> α75')) - (α76' -> α75'), L: 0 [(α77' -> (α78' -> α80')) ~ (α75' -> (α76' -> α75')), (α77' -> (α78' -> α80')) <: (α75' -> (α76' -> α75'))]]]], α75' :> α72', [α72' - list[α72'] ~ list[α76'] - α76', L: 0 [list[α72'] ~ list[α76'], list[α72'] :> α67', α67' <: list[α76']]], [α76' - (α76' -> α75') ~ (α78' -> α80') - α78', L: 1 [(α76' -> α75') ~ (α78' -> α80'), [(α76' -> α75') - (α75' -> (α76' -> α75')) ~ (α77' -> (α78' -> α80')) - (α78' -> α80'), L: 0 [(α75' -> (α76' -> α75')) ~ (α77' -> (α78' -> α80')), (α75' -> (α76' -> α75')) :> (α77' -> (α78' -> α80'))]]]], α78' <: list['a79']]

let f x =
  let g y =
    let h = x y
    in y
  in let k = g 1 in g "hi"
//│ [ERROR] Type `string` does not match `int`
//│ 
//│         (string) ---> (?a) <--- (int)
//│ 
//│ ◉ (string) is here
//│ │  - l.5    in let k = g 1 in g "hi"
//│ │                               ^^^^
//│ │  - l.2    let g y =
//│ │                 ^
//│ ▼ 
//│ ◉ (?a) is assumed here
//│ ▲  - l.2    let g y =
//│ │                 ^
//│ │ 
//│ ◉ (int) is here
//│    - l.5    in let k = g 1 in g "hi"
//│                          ^
//│ f: ((string | int) -> anything) -> (string | int)
//│ U max: 1, total: 4
//│ UERR 1 errors
//│ L: 0 [string ~ int, string <: α96', α96' :> int]
