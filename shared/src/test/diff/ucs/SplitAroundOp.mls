:NewParser

// Why? Can the type of `x` be `number | string`?
:e
fun f(x, b) =
  if x
    ==
      0 and b then "n0"
      1 and b then "n1"
      2 then "n2"
    ==
      "0" then "s0"
      "1" then "s1"
      "2" then "s2"
  else ":p"  
//│ ╔══[ERROR] Type mismatch in operator application:
//│ ║  l.6: 	  if x
//│ ║       	     ^
//│ ║  l.7: 	    ==
//│ ║       	^^^^^^
//│ ║  l.8: 	      0 and b then "n0"
//│ ║       	^^^^^^^^^^^^^^^^^^^^^^^
//│ ║  l.9: 	      1 and b then "n1"
//│ ║       	^^^^^^^^^^^^^^^^^^^^^^^
//│ ║  l.10: 	      2 then "n2"
//│ ║        	^^^^^^^^^^^^^^^^^
//│ ║  l.11: 	    ==
//│ ║        	^^^^^^
//│ ║  l.12: 	      "0" then "s0"
//│ ║        	^^^^^^^^^
//│ ╟── string literal of type `string` is not an instance of type `int`
//│ ║  l.12: 	      "0" then "s0"
//│ ╙──      	      ^^^
//│ ╔══[ERROR] Type mismatch in operator application:
//│ ║  l.6: 	  if x
//│ ║       	     ^
//│ ║  l.7: 	    ==
//│ ║       	^^^^^^
//│ ║  l.8: 	      0 and b then "n0"
//│ ║       	^^^^^^^^^^^^^^^^^^^^^^^
//│ ║  l.9: 	      1 and b then "n1"
//│ ║       	^^^^^^^^^^^^^^^^^^^^^^^
//│ ║  l.10: 	      2 then "n2"
//│ ║        	^^^^^^^^^^^^^^^^^
//│ ║  l.11: 	    ==
//│ ║        	^^^^^^
//│ ║  l.12: 	      "0" then "s0"
//│ ║        	^^^^^^^^^^^^^^^^^^^
//│ ║  l.13: 	      "1" then "s1"
//│ ║        	^^^^^^^^^
//│ ╟── string literal of type `string` is not an instance of type `int`
//│ ║  l.13: 	      "1" then "s1"
//│ ╙──      	      ^^^
//│ ╔══[ERROR] Type mismatch in operator application:
//│ ║  l.6: 	  if x
//│ ║       	     ^
//│ ║  l.7: 	    ==
//│ ║       	^^^^^^
//│ ║  l.8: 	      0 and b then "n0"
//│ ║       	^^^^^^^^^^^^^^^^^^^^^^^
//│ ║  l.9: 	      1 and b then "n1"
//│ ║       	^^^^^^^^^^^^^^^^^^^^^^^
//│ ║  l.10: 	      2 then "n2"
//│ ║        	^^^^^^^^^^^^^^^^^
//│ ║  l.11: 	    ==
//│ ║        	^^^^^^
//│ ║  l.12: 	      "0" then "s0"
//│ ║        	^^^^^^^^^^^^^^^^^^^
//│ ║  l.13: 	      "1" then "s1"
//│ ║        	^^^^^^^^^^^^^^^^^^^
//│ ║  l.14: 	      "2" then "s2"
//│ ║        	^^^^^^^^^
//│ ╟── string literal of type `string` is not an instance of type `int`
//│ ║  l.14: 	      "2" then "s2"
//│ ╙──      	      ^^^
//│ f: (int, anything,) -> string

fun f(x, y, a, b) =
  if x == 0
    and
      y == 0 then "x, y"
      a == 0 then "x, a"
      b == 0 then "x, b"
  else "nah"
//│ f: (int, int, int, int,) -> string

class A()
class B()
//│ Defined class A
//│ Defined class B
//│ A: () -> A
//│ B: () -> B

fun f(x) =
  if x
    is
      A() then 0
      B() then 1
//│ f: (A | B) -> int

// It fails because we interpret == as a constructor.
:e
:ge
if x is
  A()
    == 0 then 0
    > 0 then 1
    < 0 then 2
//│ ╔══[ERROR] Cannot find operator `==` in the context
//│ ║  l.106: 	    == 0 then 0
//│ ╙──       	    ^^
//│ res: error
