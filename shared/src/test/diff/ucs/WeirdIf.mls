:NewParser

// Should report duplicated else branches.
:w
if
  _ then 0
  else 0
else 1
//│ ╔══[WARNING] duplicated branch
//│ ╙──
//│ ╔══[WARNING] duplicated branch
//│ ╙──
//│ res: int

:w
if else 0 else 1
//│ ╔══[WARNING] duplicated branch
//│ ╙──
//│ res: int

:w
fun f(x) = if x is else 0 else 1
//│ ╔══[WARNING] duplicated branch
//│ ╙──
//│ f: anything -> int

fun f(x) = if x is else 0 
//│ f: anything -> int

:e
:ge
if true
  then 0
//│ ╔══[ERROR] Missing the otherwise case of test true
//│ ║  l.32: 	if true
//│ ╙──      	   ^^^^
//│ res: error

// This cannot be parsed. But the next one works.
:pe
:e
:ge
fun f(x) =
  if x ==
    else "bruh"
//│ ╔══[PARSE ERROR] Unexpected indented block in expression position
//│ ║  l.45: 	    else "bruh"
//│ ╙──      	^^^^
//│ ╔══[PARSE ERROR] Unexpected end of indented block; an expression was expected here
//│ ║  l.45: 	    else "bruh"
//│ ╙──      	    ^
//│ ╔══[PARSE ERROR] Expected 'then'/'else' clause; found operator application instead
//│ ║  l.44: 	  if x ==
//│ ║        	     ^^^^
//│ ║  l.45: 	    else "bruh"
//│ ║        	^^^^
//│ ╟── Note: 'if' expression started here:
//│ ║  l.44: 	  if x ==
//│ ╙──      	  ^^
//│ ╔══[ERROR] Missing the otherwise case of test == (x,) (undefined,)
//│ ║  l.44: 	  if x ==
//│ ║        	     ^^^^
//│ ║  l.45: 	    else "bruh"
//│ ╙──      	^^^^
//│ f: anything -> error

// But this works.
fun f(x) =
  if x ==
    _ then "bruh"
//│ f: anything -> string

:e
:ge
// Hmmmmmm, this one is valid but how to get it work?
fun boolToStr(x) =
  if x is
    true then "yah"
    false then "nah"
//│ ╔══[ERROR] Missing the otherwise case of test == (x,) (false,)
//│ ║  l.77: 	  if x is
//│ ║        	     ^^^^
//│ ║  l.78: 	    true then "yah"
//│ ║        	^^^^^^^^^^^^^^^^^^^
//│ ║  l.79: 	    false then "nah"
//│ ╙──      	^^^^^^^^^
//│ boolToStr: anything -> error
