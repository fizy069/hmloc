
class Person: { name: string; age: int }
def Person = fun n -> fun a -> Person { name = n; age = a }
//│ Defined class Person
//│ ╔══[ERROR] Type mismatch in application:
//│ ║  l.3: 	def Person = fun n -> fun a -> Person { name = n; age = a }
//│ ║       	                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── argument of type `({age: ?a, name: ?b},)` is not a record (expected a record with fields: name, age)
//│ ║  l.3: 	def Person = fun n -> fun a -> Person { name = n; age = a }
//│ ╙──     	                                      ^^^^^^^^^^^^^^^^^^^^^
//│ Person: anything -> anything -> (Person & {age: nothing, name: nothing})

class Animal: {}
//│ Defined class Animal

def test = fun x -> case x of
  { Person -> x.age
  | Animal -> 0
  }
//│ test: (Animal | (Person\name with {age: 'age})) -> ('age | int)

test: Person & {age: 'a} | Animal -> 'a | 0
//│ res: Animal -> int | 0 | Person

test: (Person & {age: int} | Animal) -> int
//│ ╔══[ERROR] Type mismatch in type ascription:
//│ ║  l.25: 	test: (Person & {age: int} | Animal) -> int
//│ ║        	^^^^
//│ ╟── type `int` is not an instance of `int`
//│ ║  l.25: 	test: (Person & {age: int} | Animal) -> int
//│ ║        	                      ^^^
//│ ╟── Note: constraint arises from type reference:
//│ ║  l.25: 	test: (Person & {age: int} | Animal) -> int
//│ ╙──      	                                        ^^^
//│ res: (Animal | Person) -> int

def a = Animal{}
//│ a: Animal

a: {}
//│ res: anything

def p = Person "Bob" 42
//│ p: Person & {age: nothing, name: nothing}

p: { age: int }
//│ res: {age: int}

test a
//│ res: int

test p
//│ res: int

1: int
//│ res: int


def f: 'a -> 'a & string
//│ f: nothing

def f: 'a -> ('a & string)
//│ f: 'a -> (string & 'a)

