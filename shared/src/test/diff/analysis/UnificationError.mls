:NoJS

:unify
// 0 1

:unify
let temp = if true then 0 else "oops" in 0
//│ ╔══[WARNING] Unification error (level 1): int<> and string<> cannot be unified
//│ ╟── int<> flows into α28'
//│ ╟── α28' is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── int<> is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── int<> is used as integer literal
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	                        ^
//│ ╟── string<> flows into α28'
//│ ╟── α28' is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── string<> is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── string<> is used as string literal
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ╙──     	                               ^^^^^^
//│ ╔══[WARNING] Unification error (level 1): string<> and int<> cannot be unified
//│ ╟── string<> flows into α28'
//│ ╟── α28' is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── string<> is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── string<> is used as string literal
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	                               ^^^^^^
//│ ╟── int<> flows into α28'
//│ ╟── α28' is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── int<> is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── int<> is used as integer literal
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ╙──     	                        ^
//│ ╔══[WARNING] Unification error (level 1): string<> and int<> cannot be unified
//│ ╟── string<> flows into α28'
//│ ╟── α28' is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── string<> is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── string<> is used as string literal
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	                               ^^^^^^
//│ ╟── int<> flows into α28'
//│ ╟── α28' is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── int<> is used as application
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ║       	              ^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── int<> is used as integer literal
//│ ║  l.7: 	let temp = if true then 0 else "oops" in 0
//│ ╙──     	                        ^
//│ res: int

:unify
def s x = if x then x else 3
//│ s: (bool & 'a) -> (int | 'a)

:ns
:unify
rec def clone x n =
  let rec helper acc n' =
    if acc <= 0 then acc else helper (acc + 1) (n' - 1) in
  helper x (n - 1)
//│ clone: 'clone
//│   where
//│     'clone :> 'a -> 'b -> 'c
//│     'b <: int
//│     'a <: 'd
//│     'd :> int
//│        <: int & 'e
//│     'e :> int
//│        <: 'f
//│     'f :> int
//│        <: 'c & 'g
//│     'g :> int
//│        <: 'e
//│     'c :> int

:ns
//let rec l = fun a -> fun a -> l in let rec r = fun a -> r in if true then l else r


