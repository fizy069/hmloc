:NoJS

:unifyDbg
let temp = if true then 0 else "oops" in 0
//│ [ERROR 1] string<> != int<> unifying because [[[string<>]]] | int<> <: α25'
//│ unified α25'
//│  [int<>] = α25' are arg type in ([int<>] -> α27') = (α25' -> (α25' -> α25'))
//│  α25' :> [[[int<>]]]
//│  α25' :> [[[string<>]]]
//│  α25' <: [[α28']]
//│ unified α26'
//│  α26' :> [[(α25' -> (α25' -> α25'))]]
//│  α26' <: [([int<>] -> α27')]
//│ unified α27'
//│  α27' <: [([string<>] -> α28')]
//│  α27' = (α25' -> α25') are result type in ([int<>] -> α27') = (α25' -> (α25' -> α25'))
//│ unified α28'
//│  [[α28']] = int<> because α25' <: [[α28']] and α25' :> [[[int<>]]]
//│  [[α28']] = string<> because α25' <: [[α28']] and α25' :> [[[string<>]]]
//│ res: int

:unifyDbg
def s x = if x then x else 3
//│ [ERROR 2] bool<> != int<> unifying because bool<> = int<> because [[[[α30']]]] & bool<> :> α29' and α30' :> [[[int<>]]]
//│ unified α29'
//│  α29' <: [[[[[bool<>]]]]]
//│  α29' <: [[[[α30']]]]
//│ unified α30'
//│  α30' :> [[[int<>]]]
//│  α30' <: [[α33']]
//│  [[[[α30']]]] & bool<> :> α29'
//│ unified α31'
//│  α31' :> [[(α30' -> (α30' -> α30'))]]
//│  α31' <: [([[α29']] -> α32')]
//│ unified α32'
//│  α32' <: [([int<>] -> α33')]
//│  α32' = (α30' -> α30') are result type in ([[α29']] -> α32') = (α30' -> (α30' -> α30'))
//│ unified α33'
//│  [[α33']] = int<> because α30' <: [[α33']] and α30' :> [[[int<>]]]
//│  bool<> = α33' because [[[[α30']]]] & bool<> :> α29' and α30' <: [[α33']]
//│ s: (bool & 'a) -> (int | 'a)

:unifyDbg
rec def clone x n =
  let rec helper acc n' =
    if acc <= 0 then acc else helper (acc + 1) (n' - 1) in
  helper x (n - 1)
//│ unified clone39'
//│  clone39' :> [(α40' -> (α41' -> α69'))]
//│ unified α40'
//│  [α40'] = α63' are arg type in ([([α40'],)] -> α66') = ([(α63',)] -> α64')
//│  α40' <: [[[[[[α58']]]]]]
//│ unified α41'
//│  α41' <: [[[[[[int<>]]]]]]
//│ unified helper42''
//│  helper42'' :> [(α43'' -> (α44'' -> α56''))]
//│  helper42'' <: [([(α51'',)] -> α52'')]
//│ unified α43''
//│  α43'' <: [[[[α45'']]]]
//│  α43'' <: [[[[[[int<>]]]]]]
//│ unified α44''
//│  α44'' <: [[[[[[int<>]]]]]]
//│ unified α45''
//│  α45'' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]]
//│  α45'' <: [[α56'']]
//│  [[[[[[int<>]]]]]] & α45'' :> α43''
//│ unified α46''
//│  α46'' :> [[(int<> -> bool<>)]]
//│  α46'' <: [([(int<>,)] -> α47'')]
//│ unified α47''
//│  α47'' = bool<> are result type in ([(int<>,)] -> α47'') = (int<> -> bool<>)
//│ unified α48''
//│  α48'' :> [[(α45'' -> (α45'' -> α45''))]]
//│  α48'' <: [([[α43'']] -> α49'')]
//│ unified α49''
//│  α49'' <: [([α55''] -> α56'')]
//│  α49'' = (α45'' -> α45'') are result type in ([[α43'']] -> α49'') = (α45'' -> (α45'' -> α45''))
//│ unified α50''
//│  α50'' :> [[(int<> -> int<>)]]
//│  α50'' <: [([(int<>,)] -> α51'')]
//│ unified α51''
//│  α51'' = int<> are result type in ([(int<>,)] -> α51'') = (int<> -> int<>)
//│  α51'' = α43'' are arg type in ([(α51'',)] -> α52'') = (α43'' -> (α44'' -> α56''))
//│ unified α52''
//│  α52'' <: [([(α54'',)] -> α55'')]
//│  α52'' = (α44'' -> α56'') are result type in ([(α51'',)] -> α52'') = (α43'' -> (α44'' -> α56''))
//│ unified α53''
//│  α53'' :> [[(int<> -> int<>)]]
//│  α53'' <: [([(int<>,)] -> α54'')]
//│ unified α54''
//│  α54'' <: [[[[α44'']]]]
//│  α54'' = int<> are result type in ([(int<>,)] -> α54'') = (int<> -> int<>)
//│ unified α55''
//│  int<> = α55'' because [[α56'']] = int<> because α45'' <: [[α56'']] and α45'' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]] and α56'' <: [[[α55'']]]
//│  α55'' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]]
//│  α55'' <: [[[α45'']]]
//│ unified α56''
//│  α56'' <: [[[α55'']]]
//│  [[α56'']] = int<> because α45'' <: [[α56'']] and α45'' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]]
//│ unified helper57'
//│  helper57' :> [(α58' -> (α62' -> α60'))]
//│  helper57' <: [([(α63',)] -> α64')]
//│  helper57' <: [([([α40'],)] -> α66')]
//│ unified α58'
//│  α58' <: [[[[α59']]]]
//│  α58' <: [[[[[[int<>]]]]]]
//│  [[[[[[α58']]]]]] = α63' because α40' <: [[[[[[α58']]]]]] and [α40'] = α63' are arg type in ([([α40'],)] -> α66') = ([(α63',)] -> α64')
//│ unified α59'
//│  α59' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]]
//│  α59' <: [[α60']]
//│  [[[[[[int<>]]]]]] & α59' :> α58'
//│ unified α60'
//│  α60' <: [[[α61']]]
//│  α60' <: [[[α69']]]
//│  [[α60']] = int<> because α59' <: [[α60']] and α59' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]]
//│ unified α61'
//│  α61' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]]
//│  α61' <: [[[α59']]]
//│  int<> = α61' because [[α60']] = int<> because α59' <: [[α60']] and α59' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]] and α60' <: [[[α61']]]
//│ unified α62'
//│  α62' <: [[[[[[int<>]]]]]]
//│ unified α63'
//│  α63' = α59' because [[[[[[α58']]]]]] = α63' because α40' <: [[[[[[α58']]]]]] and [α40'] = α63' are arg type in ([([α40'],)] -> α66') = ([(α63',)] -> α64') and α58' <: [[[[α59']]]]
//│  α63' = int<> because [[[[[[α58']]]]]] = α63' because α40' <: [[[[[[α58']]]]]] and [α40'] = α63' are arg type in ([([α40'],)] -> α66') = ([(α63',)] -> α64') and α58' <: [[[[[[int<>]]]]]]
//│  α63' = α58' are Tup(0) field type
//│ unified α64'
//│  α64' <: [([(α65',)] -> α61')]
//│  α64' = (α62' -> α60') are result type in ([(α63',)] -> α64') = (α58' -> (α62' -> α60'))
//│ unified α65'
//│  α65' :> [[[int<>]]]
//│  α65' <: [[[[α62']]]]
//│ unified α66'
//│  α66' <: [([(α68',)] -> α69')]
//│  α66' = (α62' -> α60') are result type in ([([α40'],)] -> α66') = (α58' -> (α62' -> α60'))
//│  α66' = α64' are result type in ([([α40'],)] -> α66') = ([(α63',)] -> α64')
//│ unified α67'
//│  α67' :> [[(int<> -> int<>)]]
//│  α67' <: [([(int<>,)] -> α68')]
//│ unified α68'
//│  α68' <: [[[[α62']]]]
//│  α68' = int<> are result type in ([(int<>,)] -> α68') = (int<> -> int<>)
//│ unified α69'
//│  α69' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]]
//│  [[[α69']]] & α61' :> α60'
//│  int<> = α69' because [[α60']] = int<> because α59' <: [[α60']] and α59' :> [[[[[[[[[[[[[[int<>]]]]]]]]]]]]]] and α60' <: [[[α69']]]
//│ clone: int -> int -> int

:unifyDbg
let rec l = fun a -> fun a -> l in let rec r = fun a -> r in if true then l else r
//│ unified l79'
//│  l79' :> [(α80' -> (α81' -> [l79']))]
//│ unified α80'
//│ unified α81'
//│ unified r82'
//│  r82' :> [(α83' -> [r82'])]
//│ unified α83'
//│ unified α84
//│  α84 = r90 because [[l86]] = α84 are arg type in ([[l86]] -> α89) = (α84 -> (α84 -> α84)) and [l86] = [r90] are result type in (α88 -> [l86]) = (α91 -> [r90])
//│  (α88 -> [l86]) = α84 because [r90] = (α88 -> [l86]) are result type in (α91 -> [r90]) = (α87 -> (α88 -> [l86])) and r90 <: [[[α84]]]
//│  α84 = (α88 -> [l86]) because [[l86]] = α84 are arg type in ([[l86]] -> α89) = (α84 -> (α84 -> α84)) and (α88 -> [l86]) = [l86] are result type in (α87 -> (α88 -> [l86])) = (α88 -> [l86])
//│  α84 :> [[[[(α87 -> (α88 -> [l86]))]]]]
//│  α84 :> [[[[(α91 -> [r90])]]]]
//│  α84 <: [[α92]]
//│ unified α85
//│  α85 :> [[(α84 -> (α84 -> α84))]]
//│  α85 <: [([[l86]] -> α89)]
//│ unified l86
//│  [l86] = [r90] are result type in (α88 -> [l86]) = (α91 -> [r90])
//│  [l86] = (α91 -> [r90]) because [r90] = [l86] are result type in (α91 -> [r90]) = (α88 -> [l86]) and r90 :> [(α91 -> [r90])]
//│  [l86] = (α88 -> [l86]) because [r90] = [l86] are result type in (α91 -> [r90]) = (α88 -> [l86]) and (α88 -> [l86]) = [r90] are result type in (α87 -> (α88 -> [l86])) = (α91 -> [r90])
//│  (α88 -> [l86]) = [l86] are result type in (α87 -> (α88 -> [l86])) = (α88 -> [l86])
//│  l86 :> [(α87 -> (α88 -> [l86]))]
//│  [[l86]] = α84 are arg type in ([[l86]] -> α89) = (α84 -> (α84 -> α84))
//│ unified α87
//│  α87 = α91 are Tup(0) field type
//│  α87 = α88 are Tup(0) field type
//│ unified α88
//│  α88 = α87 are Tup(0) field type
//│  α88 = α91 are Tup(0) field type
//│ unified α89
//│  α89 <: [([[r90]] -> α92)]
//│  α89 = (α84 -> α84) are result type in ([[l86]] -> α89) = (α84 -> (α84 -> α84))
//│ unified r90
//│  r90 :> [(α91 -> [r90])]
//│  [(α87 -> (α88 -> [l86]))] = r90 because l86 :> [(α87 -> (α88 -> [l86]))] and [l86] = [r90] are result type in (α88 -> [l86]) = (α91 -> [r90])
//│  r90 = (α87 -> (α88 -> [l86])) because (α91 -> [r90]) = r90 because [l86] = (α91 -> [r90]) because [r90] = [l86] are result type in (α91 -> [r90]) = (α88 -> [l86]) and r90 :> [(α91 -> [r90])] and [l86] = [r90] are result type in (α88 -> [l86]) = (α91 -> [r90]) and [(α87 -> (α88 -> [l86]))] = r90 because l86 :> [(α87 -> (α88 -> [l86]))] and [l86] = [r90] are result type in (α88 -> [l86]) = (α91 -> [r90])
//│  (α91 -> [r90]) = r90 because [l86] = (α91 -> [r90]) because [r90] = [l86] are result type in (α91 -> [r90]) = (α88 -> [l86]) and r90 :> [(α91 -> [r90])] and [l86] = [r90] are result type in (α88 -> [l86]) = (α91 -> [r90])
//│  (α88 -> [l86]) = [r90] are result type in (α87 -> (α88 -> [l86])) = (α91 -> [r90])
//│  r90 <: [[[α84]]]
//│  [r90] = [l86] are result type in (α91 -> [r90]) = (α88 -> [l86])
//│  [r90] = (α88 -> [l86]) are result type in (α91 -> [r90]) = (α87 -> (α88 -> [l86]))
//│ unified α91
//│  α91 = α88 are Tup(0) field type
//│  α91 = α87 are Tup(0) field type
//│ unified α92
//│  [[α92]] = r90 because α84 <: [[α92]] and α84 = r90 because [[l86]] = α84 are arg type in ([[l86]] -> α89) = (α84 -> (α84 -> α84)) and [l86] = [r90] are result type in (α88 -> [l86]) = (α91 -> [r90])
//│  [[α92]] = (α88 -> [l86]) because α84 <: [[α92]] and α84 = (α88 -> [l86]) because [[l86]] = α84 are arg type in ([[l86]] -> α89) = (α84 -> (α84 -> α84)) and (α88 -> [l86]) = [l86] are result type in (α87 -> (α88 -> [l86])) = (α88 -> [l86])
//│  [[α92]] = (α87 -> (α88 -> [l86])) because α84 <: [[α92]] and α84 :> [[[[(α87 -> (α88 -> [l86]))]]]]
//│  [[α92]] = (α91 -> [r90]) because α84 <: [[α92]] and α84 :> [[[[(α91 -> [r90])]]]]
//│ res: 'l | 'r
//│   where
//│     'r :> anything -> 'r
//│     'l :> anything -> anything -> 'l
